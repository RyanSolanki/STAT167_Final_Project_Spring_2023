---
title: "STAT 167 Final Project"
author: "Girum Yaye"
date: "2023-05-29"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.


```{r}
library(dplyr)
library(tidyverse)
library(ggplot2)
```

```{r}
car_prices <- read.csv("~/Downloads/STAT167/car_prices.csv")
head(car_prices, 10)
car_prices$mmr <- as.numeric(car_prices$mmr)
dim(car_prices)
car_prices <- car_prices %>% drop_na()
car_prices <- subset(car_prices, select = -c(vin, seller, saledate))
```

```{r}
car_prices$body <- tolower(car_prices$body)

selling_prices_high <- car_prices %>%
  group_by(make) %>%
  arrange(desc(sellingprice)) %>%
  head(200)
selling_prices_high <- selling_prices_high %>% drop_na()

ggplot(data = selling_prices_high) +
  geom_col(mapping = aes(x = make, y = sellingprice, fill = body)) +
  labs(x = "make", y = "selling price", title = "highest selling price vs. make of the car") + coord_flip()

selling_prices_low <- car_prices %>%
  group_by(make) %>%
  arrange(desc(-sellingprice)) %>%
  head(100)
selling_prices_low <- selling_prices_low %>% drop_na()

ggplot(data = selling_prices_low) +
  geom_col(mapping = aes(x = make, y = sellingprice, fill = body)) +
  labs(x = "make", y = "selling price", title = "lowest selling price vs. make of the car") + coord_flip()
```

```{r}
car_prices <- mutate(car_prices, diff = sellingprice - mmr)
difference_sp_mmr <- car_prices %>%
  group_by(make) %>%
  arrange(desc(diff)) %>%
  head(100)

ggplot(data = difference_sp_mmr) +
  geom_boxplot(mapping = aes(x = state, y = diff))
```

